var VimeoUpload=function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,n){"use strict";t.__esModule=!0,t.DEFAULT_VALUES={preferredUploadDuration:30,chunkSize:1048576,token:"TOKEN_STRING_HERE",supportedFiles:["mov","mpeg4","mp4","avi","wmv","mpegps","flv","3gpp","webm"],name:"",description:"",file:null,upgrade_to_1080:!1},t.DEFAULT_EVENTS={chunkprogresschanged:function(e){return console.log("Default: Chunk Progress Update: "+e.detail+"/100")},totalprogresschanged:function(e){return console.log("Default: Total Progress Update: "+e.detail+"/100")},estimatedtimechanged:function(e){return console.log("Default: Estimated Time Update: "+e.detail)},estimateduploadspeedchanged:function(e){return console.log("Default: Estimated Upload Speed Changed: "+e.detail+" mb/s")},uploadaborted:function(e){return console.log("Default: Upload aborted detected.")}}},function(e,t,n){"use strict";t.__esModule=!0;var i=n(0),o=function(){function e(){}return e.Add=function(e,t){window.addEventListener(e,t,!1)},e.Remove=function(e,t){window.removeEventListener(e,t,!1)},e.Dispatch=function(e,t){void 0===t&&(t=null);var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},e.Exists=function(e){return i.DEFAULT_EVENTS.hasOwnProperty(e)},e.GetDefault=function(e){return i.DEFAULT_EVENTS[e]},e}();t.EventService=o},function(e,t,n){"use strict";t.__esModule=!0;var i=n(7),o=n(5),r=n(8),s=n(1),c=function(){function e(t,n,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.request=e.CreateRequest(t,n,i,o)}return e.prototype.send=function(t){return void 0===t&&(t=!1),e.Send(this.request,t)},e.CreateRequest=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null);var s=[];for(var c in r)r.hasOwnProperty(c)&&s.push(new o.Header(c,r[c]));return new i.Request(e,t,n,s)},e.Send=function(e,t){return void 0===t&&(t=!1),new Promise(function(n,i){var o=new XMLHttpRequest;o.open(e.method,e.url,!0),e.headers.forEach(function(e){return o.setRequestHeader(e.title,e.value)}),window.addEventListener("uploadaborted",function(){o.abort()},!1),o.onload=function(){var t=new Date,s=null;try{s=JSON.parse(o.response)}catch(e){console.warn("Unable to parse xhr return response."),s=o.response}var c=new r.Response(o.status,o.statusText,s);new Date(null);switch(c.duration=t.getTime()-e.startTime,!0){case o.status>=200&&o.status<300:n(c);break;case 308===o.status:c.range=o.getResponseHeader("Range"),n(c);break;default:i(c)}},o.onerror=function(){i(new r.Response(o.status,o.statusText,o.response||null))},t&&o.upload.addEventListener("progress",function(e){if(e.lengthComputable){var t=Math.floor(e.loaded/e.total*100);s.EventService.Dispatch("chunkprogresschanged",t)}}),e.startTime=(new Date).getTime();try{o.send(e.data)}catch(e){console.error("An error occured while sending.",e)}})},e}();t.HttpService=c},function(e,t,n){"use strict";t.__esModule=!0;var i=n(14),o=n(12),r=n(15),s=n(0),c=n(1),u=n(17),a=n(16),d=n(13),l=function(){function e(e){void 0===e&&(e={});for(var t in e)if(e.hasOwnProperty(t))switch(!0){case s.DEFAULT_VALUES.hasOwnProperty(t):s.DEFAULT_VALUES[t]=e[t];break;default:console.warn("Unrecognized property: "+t)}this.ticketService=new i.TicketService(s.DEFAULT_VALUES.token),this.mediaService=new d.MediaService(s.DEFAULT_VALUES),this.chunkService=new o.ChunkService(this.mediaService,s.DEFAULT_VALUES.preferredUploadDuration,s.DEFAULT_VALUES.chunkSize),this.uploadService=new r.UploadService(this.mediaService,this.ticketService),this.validatorService=new a.ValidatorService(s.DEFAULT_VALUES.supportedFiles)}return e.prototype.start=function(e){var t=this;void 0===e&&(e={}),this.mediaService.setData(e),e.token&&(this.ticketService.token=s.DEFAULT_VALUES.token=e.token),this.validatorService.isSupported(this.mediaService.media.file)&&this.ticketService.open().then(function(e){console.log(e),t.ticketService.save(e),t.process()}).catch(function(e){console.log("Error occured while generating ticket. "+e)})},e.prototype.process=function(){var e=this;console.log("Processing");var t=this.chunkService.create();console.log(t.content,t.contentRange),this.uploadService.send(t).then(function(t){c.EventService.Dispatch("estimatedtimechanged",t.duration),c.EventService.Dispatch("estimateduploadspeedchanged",e.chunkService.size/t.duration);var n=u.TimeUtil.TimeToSeconds(t.duration);e.chunkService.updateSize(n),e.check()}).catch(function(e){console.error("Error sending chunk",e)})},e.prototype.check=function(){var e=this;this.uploadService.getRange().then(function(t){switch(t.status){case 308:if(console.log("New range "+t.range),e.chunkService.updateOffset(t.range),c.EventService.Dispatch("totalprogresschanged",e.chunkService.getPercent()),e.chunkService.isDone())return void e.done();e.process();break;case 200:e.ticketService.close().then(function(e){console.log(e)}).catch(function(e){console.log(e)});break;default:console.warn("Unrecognized status code ("+t.status+") for chunk range.")}}).catch(function(e){console.error("Error getting chunk range",e)})},e.prototype.done=function(){this.ticketService.close().then(function(e){console.log("Delete success:",e)}).catch(function(e){console.warn("Delete failed:",e)})},e.prototype.abort=function(){c.EventService.Dispatch("uploadaborted"),this.done()},e.On=function(e,t){void 0===t&&(t=null),c.EventService.Exists(e)&&(null===t&&(t=c.EventService.GetDefault(e)),c.EventService.Add(e,t))},e.Off=function(e,t){void 0===t&&(t=null),c.EventService.Exists(e)&&(null===t&&(t=c.EventService.GetDefault(e)),c.EventService.Remove(e,t))},e}();t.App=l},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t){this.content=e,this.contentRange=t}return e}();t.Chunk=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t){this.title=e,this.value=t}return e}();t.Header=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t,n,i){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=null),void 0===i&&(i=!1),this.name=e,this.description=t,this.file=n,this.upgrade_to_1080=i}return e}();t.Media=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=[]),this.method=e,this.url=t,this.data=n,this.headers=i,this.startTime=-1}return e}();t.Request=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t,n,i){void 0===n&&(n=null),void 0===i&&(i=null),this.status=e,this.statusText=t,this.data=n,this.duration=i,this.range=null}return e}();t.Response=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e,t,n,i,o){this.uploadLinkSecure=e,this.ticketId=t,this.uploadLink=n,this.completeUri=i,this.user=o}return e}();t.Ticket=i},function(e,t,n){"use strict";t.__esModule=!0;var e,i=n(3);e.exports=i.App},function(e,t,n){"use strict";t.__esModule=!0,t.VIMEO_ROUTES={DEFAULT:function(e){return void 0===e&&(e=""),"https://api.vimeo.com"+e},TICKET:function(){return t.VIMEO_ROUTES.DEFAULT()+"/me/videos"}}},function(e,t,n){"use strict";t.__esModule=!0;var i=n(4),o=function(){function e(e,t,n,i){void 0===i&&(i=0),this.mediaService=e,this.preferredUploadDuration=t,this.size=n,this.offset=i}return e.prototype.updateSize=function(e){console.log(this.size,e,this.preferredUploadDuration),this.size=Math.floor(this.size*this.preferredUploadDuration/e)},e.prototype.create=function(){var e=Math.min(this.offset+this.size,this.mediaService.media.file.size),t=this.mediaService.media.file.slice(this.offset,e);return new i.Chunk(t,"bytes "+this.offset+"-"+e+"/"+this.mediaService.media.file.size)},e.prototype.updateOffset=function(e){this.offset=parseInt(e.match(/\d+/g).pop(),10)+1},e.prototype.getPercent=function(){return Math.floor(this.offset/this.mediaService.media.file.size*100)},e.prototype.isDone=function(){return this.offset>=this.mediaService.media.file.size},e}();t.ChunkService=o},function(e,t,n){"use strict";t.__esModule=!0;var i=n(6),o=function(){function e(e){this.options=e,this.media=new i.Media,this.setData(e)}return e.prototype.setData=function(e){for(var t in e)e.hasOwnProperty(t)&&this.media.hasOwnProperty(t)&&(this.media[t]=e[t]);null!==this.media.file&&""===this.media.name&&(this.media.name=this.media.file.name)},e}();t.MediaService=o},function(e,t,n){"use strict";t.__esModule=!0;var i=n(2),o=n(9),r=n(11),s=function(){function e(e){this.token=e}return e.prototype.open=function(){return new i.HttpService("POST",r.VIMEO_ROUTES.TICKET(),JSON.stringify({type:"streaming"}),{Authorization:"Bearer "+this.token,"Content-Type":"application/json"}).send()},e.prototype.save=function(e){this.ticket=new o.Ticket(e.data.upload_link_secure,e.data.ticket_id,e.data.upload_link,e.data.complete_uri,e.data.user)},e.prototype.close=function(){return new i.HttpService("DELETE",r.VIMEO_ROUTES.DEFAULT(this.ticket.completeUri),null,{Authorization:"Bearer "+this.token}).send()},e}();t.TicketService=s},function(e,t,n){"use strict";t.__esModule=!0;var i=n(2),o=function(){function e(e,t){this.mediaService=e,this.ticketService=t}return e.prototype.send=function(e){return console.log(e.content,e.contentRange),new i.HttpService("PUT",this.ticketService.ticket.uploadLinkSecure,e.content,{"Content-Type":this.mediaService.media.file.type,"Content-Range":e.contentRange}).send(!0)},e.prototype.getRange=function(){return new i.HttpService("PUT",this.ticketService.ticket.uploadLinkSecure,null,{"Content-Type":this.mediaService.media.file.type,"Content-Range":"bytes */* "}).send()},e}();t.UploadService=o},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(e){this.supportedFiles=e}return e.prototype.isSupported=function(e){var t=e.type;if(-1===t.indexOf("/"))return console.warn("Wrong type found ("+t+")."),!1;var n=t.split("/");return"video"!==n[0]?(console.warn("Only videos are supported, "+t+" given."),!1):this.supportedFiles.includes(n[1])},e}();t.ValidatorService=i},function(e,t,n){"use strict";t.__esModule=!0;var i=function(){function e(){}return e.TimeToSeconds=function(e){return e/1e3},e.TimeToString=function(e){var t=new Date(null);return t.setTime(e),t.toISOString().substr(11,8)},e}();t.TimeUtil=i}]);