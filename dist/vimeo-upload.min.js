var VimeoUpload=function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,i){"use strict";e.__esModule=!0;var n=i(9),o=i(10),a=i(11),r=i(2),s=i(1),c=function(){function t(t){this.maxAcceptedUploadDuration=t}return t.DefaultResolver=function(t){var e=null;try{e=JSON.parse(t.response)}catch(i){e=t.response}var i=new a.Response(t.status,t.statusText,e);return t.status>=400&&(i.statusCode=s.Status.Rejected),i},t.prototype.send=function(e,i,n){return void 0===i&&(i=null),void 0===n&&(n=null),new Promise(function(o,c){var u=new XMLHttpRequest;u.open(e.method,e.url,!0),e.headers.forEach(function(t){return u.setRequestHeader(t.title,t.value)}),window.addEventListener("uploadaborted",function(){u.abort()},!1),u.onload=function(){null!==i&&(i.end=new Date,i.done=!0);var e=t.DefaultResolver(u);switch(!0){case e.statusCode===s.Status.Resolved:o(e);break;case e.statusCode===s.Status.Neutral&&null!==n:n(u,e),e.statusCode===s.Status.Resolved?o(e):c(e);break;case e.statusCode===s.Status.Neutral&&null===n:u.status<300?o(e):c(e);break;default:c(e)}},u.onabort=function(){c(new a.Response(u.status,u.statusText,u.response))},u.onerror=function(){c(new a.Response(u.status,u.statusText,u.response||null))},null!=i&&u.upload.addEventListener("progress",function(t){t.lengthComputable&&(i.loaded=t.loaded,i.total=t.total,i.end=new Date,r.TimeUtil.TimeToSeconds(i.end.getTime()-i.start.getTime())>2*i.prefferedDuration&&(i.loaded=0,i.total=0,i.done=!0,u.abort()))});try{u.send(e.data)}catch(t){console.error("An error occured while sending.",t)}})},t.CreateRequest=function(t,e,i,a){void 0===i&&(i=null),void 0===a&&(a=null);var r=[];for(var s in a)a.hasOwnProperty(s)&&r.push(new o.Header(s,a[s]));return new n.Request(t,e,i,r)},t}();e.HttpService=c},function(t,e,i){"use strict";e.__esModule=!0;!function(t){t[t.Neutral=0]="Neutral",t[t.Rejected=1]="Rejected",t[t.Resolved=2]="Resolved"}(e.Status||(e.Status={}))},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(){}return t.TimeToSeconds=function(t){return t/1e3},t.TimeToString=function(t){var e=new Date(null);return e.setTime(t),e.toISOString().substr(11,8)},t.MilisecondsToString=function(e){var i=t.TimeToSeconds(e),n=new Date(null);return n.setSeconds(i),n.toISOString().substr(11,8)},t}();e.TimeUtil=n},function(t,e,i){"use strict";e.__esModule=!0,e.VIMEO_ROUTES={DEFAULT:function(t){return void 0===t&&(t=""),"https://api.vimeo.com"+t},TICKET:function(){return e.VIMEO_ROUTES.DEFAULT()+"/me/videos"},VIDEOS:function(t){return""+e.VIMEO_ROUTES.DEFAULT("/videos/"+t)}}},function(t,e,i){"use strict";e.__esModule=!0,e.DEFAULT_VALUES={preferredUploadDuration:20,chunkSize:1048576,token:"TOKEN_STRING_HERE",supportedFiles:["mov","mpeg4","mp4","avi","wmv","mpegps","flv","3gpp","webm"],name:"",description:"",file:null,upgrade_to_1080:!1,timeInterval:150,maxAcceptedFails:20,maxAcceptedUploadDuration:60},e.DEFAULT_EVENTS={chunkprogresschanged:function(t){return console.log("Default: Chunk Progress Update: "+t.detail+"/100")},totalprogresschanged:function(t){return console.log("Default: Total Progress Update: "+t.detail+"/100")},estimatedtimechanged:function(t){return console.log("Default: Estimated Time Update: "+t.detail)},estimatedchunktimechanged:function(t){return console.log("Default: Estimated Chunk Time Update: "+t.detail)},estimateduploadspeedchanged:function(t){return console.log("Default: Estimated Upload Speed Changed: "+t.detail+" mb/s")},uploadaborted:function(t){return console.log("Default: Upload aborted detected.")}}},function(t,e,i){"use strict";e.__esModule=!0;var n=i(4),o=function(){function t(){}return t.Add=function(t,e){window.addEventListener(t,e,!1)},t.Remove=function(t,e){window.removeEventListener(t,e,!1)},t.Dispatch=function(t,e){void 0===e&&(e=null);var i=new CustomEvent(t,{detail:e});window.dispatchEvent(i)},t.Exists=function(t){return n.DEFAULT_EVENTS.hasOwnProperty(t)},t.GetDefault=function(t){return n.DEFAULT_EVENTS[t]},t}();e.EventService=o},function(t,e,i){"use strict";e.__esModule=!0;var t,n=i(7);t.exports=n.App},function(t,e,i){"use strict";e.__esModule=!0;var n=i(8),o=i(13),a=i(15),r=i(4),s=i(5),c=i(16),u=i(17),d=i(0),l=i(19),p=function(){function t(){this.failCount=0}return t.prototype.init=function(t){void 0===t&&(t={});for(var e in t)if(t.hasOwnProperty(e))switch(!0){case r.DEFAULT_VALUES.hasOwnProperty(e):r.DEFAULT_VALUES[e]=t[e];break;default:console.warn("Unrecognized property: "+e)}this.maxAcceptedFails=r.DEFAULT_VALUES.maxAcceptedFails,this.httpService=new d.HttpService(r.DEFAULT_VALUES.maxAcceptedUploadDuration),this.mediaService=new u.MediaService(this.httpService,r.DEFAULT_VALUES),this.chunkService=new o.ChunkService(this.mediaService,r.DEFAULT_VALUES.preferredUploadDuration,r.DEFAULT_VALUES.chunkSize),this.statService=new l.StatService(r.DEFAULT_VALUES.timeInterval,this.chunkService),this.ticketService=new n.TicketService(r.DEFAULT_VALUES.token,this.httpService,r.DEFAULT_VALUES.upgrade_to_1080),this.uploadService=new a.UploadService(this.mediaService,this.ticketService,this.httpService,this.statService),this.validatorService=new c.ValidatorService(r.DEFAULT_VALUES.supportedFiles)},t.prototype.start=function(t){var e=this;void 0===t&&(t={}),this.init(t),this.validatorService.isSupported(this.mediaService.media.file)&&this.ticketService.open().then(function(t){console.log(t),e.ticketService.save(t),e.statService.start(),e.process()}).catch(function(t){console.log("Error occured while generating ticket. "+t)})},t.prototype.process=function(){var t=this,e=this.chunkService.create();console.log(e.content,e.contentRange),this.uploadService.send(e).then(function(e){t.chunkService.updateSize(t.statService.getChunkUploadDuration()),t.check()}).catch(function(e){t.failCount<=t.maxAcceptedFails&&(t.failCount++,console.error("Error sending chunk: "+t.failCount),t.chunkService.updateSize(t.statService.getChunkUploadDuration()),t.check())})},t.prototype.check=function(){var t=this;this.uploadService.getRange().then(function(e){switch(e.status){case 308:if(t.chunkService.updateOffset(e.responseHeaderData),t.chunkService.isDone())return void t.done();t.process();break;case 200:t.ticketService.close().then(function(t){console.log(t)}).catch(function(t){console.log(t)});break;default:console.warn("Unrecognized status code ("+e.status+") for chunk range.")}}).catch(function(t){console.error("Error getting chunk range",t)})},t.prototype.done=function(){var t=this;this.statService.totalStatData.done=!0,this.ticketService.close().then(function(e){t.statService.stop(),console.log("Delete success:",e)}).catch(function(e){t.statService.stop(),console.warn("Delete failed:",e)})},t.prototype.abort=function(){s.EventService.Dispatch("uploadaborted"),this.done()},t.prototype.on=function(t,e){void 0===e&&(e=null),s.EventService.Exists(t)&&(null===e&&(e=s.EventService.GetDefault(t)),s.EventService.Add(t,e))},t.prototype.off=function(t,e){void 0===e&&(e=null),s.EventService.Exists(t)&&(null===e&&(e=s.EventService.GetDefault(t)),s.EventService.Remove(t,e))},t}();e.App=p},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=i(12),a=i(3),r=i(1),s=function(){function t(t,e,i){this.token=t,this.httpService=e,this.upgrade_to_1080=i}return t.prototype.open=function(){var t={type:"streaming"};this.upgrade_to_1080&&(t.upgrade_to_1080=this.upgrade_to_1080);var e=n.HttpService.CreateRequest("POST",a.VIMEO_ROUTES.TICKET(),JSON.stringify(t),{Authorization:"Bearer "+this.token,"Content-Type":"application/json"});return this.httpService.send(e)},t.prototype.save=function(t){this.ticket=new o.Ticket(t.data.upload_link_secure,t.data.ticket_id,t.data.upload_link,t.data.complete_uri,t.data.user)},t.prototype.close=function(){var e=n.HttpService.CreateRequest("DELETE",a.VIMEO_ROUTES.DEFAULT(this.ticket.completeUri),null,{Authorization:"Bearer "+this.token});return this.httpService.send(e,null,t.CloseResolver)},t.CloseResolver=function(t,e){t.status<400&&(e.statusCode=r.Status.Resolved,e.responseHeaderData=t.getResponseHeader("Location"))},t}();e.TicketService=s},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e,i,n){void 0===i&&(i=null),void 0===n&&(n=[]),this.method=t,this.url=e,this.data=i,this.headers=n}return t}();e.Request=n},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e){this.title=t,this.value=e}return t}();e.Header=n},function(t,e,i){"use strict";e.__esModule=!0;var n=i(1),o=function(){function t(t,e,i){void 0===i&&(i=null),this.status=t,this.statusText=e,this.data=i,this.responseHeaderData=null,this.duration=-1,this.statusCode=n.Status.Neutral}return t}();e.Response=o},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e,i,n,o){this.uploadLinkSecure=t,this.ticketId=e,this.uploadLink=i,this.completeUri=n,this.user=o}return t}();e.Ticket=n},function(t,e,i){"use strict";e.__esModule=!0;var n=i(14),o=function(){function t(t,e,i,n){void 0===n&&(n=0),this.mediaService=t,this.preferredUploadDuration=e,this.size=i,this.offset=n}return t.prototype.updateSize=function(t){this.size=Math.floor(this.size*this.preferredUploadDuration/t)},t.prototype.create=function(){var t=Math.min(this.offset+this.size,this.mediaService.media.file.size);t-this.offset!==this.size&&this.updateSize(t-this.offset);var e=this.mediaService.media.file.slice(this.offset,t);return new n.Chunk(e,"bytes "+this.offset+"-"+t+"/"+this.mediaService.media.file.size)},t.prototype.updateOffset=function(t){this.offset=parseInt(t.match(/\d+/g).pop(),10)+1},t.prototype.isDone=function(){return this.offset>=this.mediaService.media.file.size},t}();e.ChunkService=o},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e){this.content=t,this.contentRange=e}return t}();e.Chunk=n},function(t,e,i){"use strict";e.__esModule=!0;var n=i(0),o=i(1),a=function(){function t(t,e,i,n){this.mediaService=t,this.ticketService=e,this.httpService=i,this.statService=n}return t.prototype.send=function(t){console.log(t.content,t.contentRange);var e=this.statService.create();this.statService.save(e);var i=n.HttpService.CreateRequest("PUT",this.ticketService.ticket.uploadLinkSecure,t.content,{"Content-Type":this.mediaService.media.file.type,"Content-Range":t.contentRange});return this.httpService.send(i,e)},t.prototype.getRange=function(){var e=n.HttpService.CreateRequest("PUT",this.ticketService.ticket.uploadLinkSecure,null,{"Content-Type":this.mediaService.media.file.type,"Content-Range":"bytes */* "});return this.httpService.send(e,null,t.RangeResolver)},t.RangeResolver=function(t,e){switch(t.status){case 308:e.responseHeaderData=t.getResponseHeader("Range"),e.statusCode=o.Status.Resolved;break;case 200:e.statusCode=o.Status.Resolved;break;default:console.warn("Unexpected xhr status found ("+t.status+").")}308===t.status&&(e.responseHeaderData=t.getResponseHeader("Range"))},t}();e.UploadService=a},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t){this.supportedFiles=t}return t.prototype.isSupported=function(t){var e=t.type;if(-1===e.indexOf("/"))return console.warn("Wrong type found ("+e+")."),!1;var i=e.split("/");return"video"!==i[0]?(console.warn("Only videos are supported, "+e+" given."),!1):this.supportedFiles.includes(i[1])},t}();e.ValidatorService=n},function(t,e,i){"use strict";e.__esModule=!0;var n=i(18),o=i(0),a=i(3),r=function(){function t(t,e){this.httpService=t,this.options=e,this.media=new n.Media,this.setData(e)}return t.prototype.setData=function(t){for(var e in t)t.hasOwnProperty(e)&&this.media.hasOwnProperty(e)&&(this.media[e]=t[e]);null!==this.media.file&&""===this.media.name&&(this.media.name=this.media.file.name)},t.prototype.updateVideoData=function(t,e){var i=o.HttpService.CreateRequest("PATCH",a.VIMEO_ROUTES.VIDEOS(e),JSON.stringify(this.media.toJSON()),{Authorization:"Bearer "+t});return this.httpService.send(i)},t}();e.MediaService=r},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e,i,n){void 0===t&&(t=""),void 0===e&&(e=""),void 0===i&&(i=null),void 0===n&&(n=!1),this.name=t,this.description=e,this.file=i,this.upgrade_to_1080=n}return t.prototype.toJSON=function(){return{name:this.name,description:this.description}},t}();e.Media=n},function(t,e,i){"use strict";e.__esModule=!0;var n=i(5),o=i(2),a=i(20),r=function(){function t(t,e){this.timeInterval=t,this.chunkService=e,this.si=-1,this.previousTotalPercent=0}return t.prototype.start=function(){this.totalStatData=this.create(!0),this.startInterval()},t.prototype.create=function(t){void 0===t&&(t=!1);var e=new Date,i=t?this.chunkService.mediaService.media.file.size:this.chunkService.size;return new a.StatData(e,e,this.chunkService.preferredUploadDuration,0,i)},t.prototype.save=function(t){this.chunkStatData=t},t.prototype.estimateTimeLeft=function(t){var e=Math.floor((new Date).getTime()-t.start.getTime()),i=this.calculateRatio(t.loaded,t.total);return i>0?Math.floor(e*i):e},t.prototype.calculateRatio=function(t,e){return t/e},t.prototype.calculatePercent=function(t,e){return Math.floor(100*this.calculateRatio(t,e))},t.prototype.calculateUploadSpeed=function(t){return t>0?Math.floor(this.chunkStatData.total/t):0},t.prototype.updateTotal=function(){this.totalStatData.loaded+=this.chunkStatData.total},t.prototype.startInterval=function(){var t=this;this.si>-1&&this.stop(),this.si=setInterval(function(){var e=t.calculatePercent(t.chunkStatData.loaded,t.chunkStatData.total);t.chunkStatData.done&&(t.updateTotal(),t.chunkStatData.total=t.chunkStatData.loaded=0,e=100),t.totalStatData.end=t.chunkStatData.end,t.previousTotalPercent=Math.max(t.totalStatData.loaded+t.chunkStatData.loaded,t.previousTotalPercent);var i=t.calculatePercent(t.previousTotalPercent,t.totalStatData.total),a=!t.chunkStatData||t.chunkStatData.done?0:t.estimateTimeLeft(t.chunkStatData),r=o.TimeUtil.TimeToSeconds(a),s=t.estimateTimeLeft(t.totalStatData),c=o.TimeUtil.TimeToSeconds(s),u=t.calculateUploadSpeed(r);n.EventService.Dispatch("estimatedtimechanged",{seconds:c,timeFormat:o.TimeUtil.MilisecondsToString(s)}),n.EventService.Dispatch("estimatedchunktimechanged",{seconds:r,timeFormat:o.TimeUtil.MilisecondsToString(a)}),n.EventService.Dispatch("chunkprogresschanged",e),t.totalStatData.done&&(i=100),n.EventService.Dispatch("estimateduploadspeedchanged",u),n.EventService.Dispatch("totalprogresschanged",i)},this.timeInterval)},t.prototype.stop=function(){clearInterval(this.si)},t.prototype.getChunkUploadDuration=function(){return o.TimeUtil.TimeToSeconds(this.chunkStatData.end.getTime()-this.chunkStatData.start.getTime())},t.prototype.chunkIsOverPrefferedUploadTime=function(){return this.getChunkUploadDuration()>=1.5*this.chunkService.preferredUploadDuration},t}();e.StatService=r},function(t,e,i){"use strict";e.__esModule=!0;var n=function(){function t(t,e,i,n,o,a){void 0===n&&(n=0),void 0===o&&(o=0),void 0===a&&(a=!1),this.start=t,this.end=e,this.prefferedDuration=i,this.loaded=n,this.total=o,this.done=a}return t}();e.StatData=n}]);